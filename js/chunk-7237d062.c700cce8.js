(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7237d062"],{"106b":function(t,e,a){"use strict";a.d(e,"l",(function(){return n})),a.d(e,"j",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"g",(function(){return l})),a.d(e,"e",(function(){return u})),a.d(e,"m",(function(){return c})),a.d(e,"i",(function(){return o})),a.d(e,"n",(function(){return d})),a.d(e,"c",(function(){return p})),a.d(e,"h",(function(){return m})),a.d(e,"f",(function(){return h})),a.d(e,"k",(function(){return f})),a.d(e,"a",(function(){return v})),a.d(e,"o",(function(){return g})),a.d(e,"d",(function(){return b}));var r=a("b775"),n=function(t){return r["a"].request({url:"template/query",method:"post",data:t})},s=function(t){return r["a"].request({url:"template/".concat(t),method:"get"})},i=function(t){return r["a"].request({url:"template",method:"post",data:t})},l=function(t){return r["a"].request({url:"template",method:"put",data:t})},u=function(t){return r["a"].request({url:"template/".concat(t),method:"delete"})},c=function(t){return r["a"].request({url:"template/templatePreview?path=".concat(t),method:"get"})},o=function(t){return r["a"].request({url:"template/getAllTemplateFields",method:"get"})},d=function(t){return r["a"].request({url:"unitTemplate/query",method:"post",data:t})},p=function(t){return r["a"].request({url:"unitTemplate",method:"post",data:t})},m=function(t){return r["a"].request({url:"unitTemplate",method:"put",data:t})},h=function(t){return r["a"].request({url:"unitTemplate/".concat(t),method:"delete"})},f=function(t){return r["a"].request({url:"printManger/queryPrinter",method:"post",data:t})},v=function(t){return r["a"].request({url:"printManger/addPrinter",method:"post",data:t})},g=function(t){return r["a"].request({url:"printManger/updatePrinter",method:"put",data:t})},b=function(t){return r["a"].request({url:"printManger/deletePrinter/".concat(t),method:"delete"})}},2934:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"e",(function(){return s})),a.d(e,"c",(function(){return i})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return u})),a.d(e,"f",(function(){return c}));var r=a("b775"),n=function(){return r["a"].request({url:"productProcessManagement/queryAll",method:"get"})},s=function(){return r["a"].request({url:"siteManagement/queryAll",method:"get"})},i=function(){return r["a"].request({url:"sysRole/queryAllRoles",method:"get"})},l=function(){return r["a"].request({url:"template/queryAllTemplates",method:"get"})},u=function(){return r["a"].request({url:"workOrder/printerList",method:"get"})},c=function(t){return r["a"].request({url:"upload",method:"post",data:t})}},"307d":function(t,e,a){"use strict";(function(e){function a(t){return(t+"===".slice((t.length+3)%4)).replace(/-/g,"+").replace(/_/g,"/")}function r(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function n(t,a){return r(e.from(t,a||"utf8").toString("base64"))}function s(t,r){return e.from(a(t),"base64").toString(r||"utf8")}t.exports={unescape:a,escape:r,encode:n,decode:s}}).call(this,a("b639").Buffer)},8821:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box"},[e("div",{staticClass:"search-form"},[e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("模板名称：")]),e("el-input",{attrs:{size:"small",placeholder:"请输入模板名称"},model:{value:t.data.templateName,callback:function(e){t.$set(t.data,"templateName",e)},expression:"data.templateName"}})],1),e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("模板类型：")]),e("el-select",{attrs:{size:"small",placeholder:"请选择模板类型"},model:{value:t.data.templateType,callback:function(e){t.$set(t.data,"templateType",e)},expression:"data.templateType"}},[e("el-option",{attrs:{label:"内标签",value:0}}),e("el-option",{attrs:{label:"外标签",value:1}})],1)],1),e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("关联打印机：")]),e("el-select",{attrs:{size:"small",placeholder:"请选择模板类型"},model:{value:t.data.templatePrinter,callback:function(e){t.$set(t.data,"templatePrinter",e)},expression:"data.templatePrinter"}},t._l(t.printerList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("宽(mm)：")]),e("el-input",{attrs:{size:"small",type:"number",placeholder:"请输入模板名称"},model:{value:t.data.templateWidth,callback:function(e){t.$set(t.data,"templateWidth",e)},expression:"data.templateWidth"}})],1),e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("高(mm)：")]),e("el-input",{attrs:{size:"small",type:"number",placeholder:"请输入模板名称"},model:{value:t.data.templateHeight,callback:function(e){t.$set(t.data,"templateHeight",e)},expression:"data.templateHeight"}})],1),e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"}),e("el-button",{attrs:{size:"small"},on:{click:t.cancel}},[t._v("返 回")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.save}},[t._v("发 布")])],1)]),e("div",{staticClass:"search-form"},[e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("模板上传：")]),t.data.templateContent?e("div",{staticClass:"file-preview"},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.data.templatePreview,fit:"contain"}}),e("i",{staticClass:"el-icon-delete-solid delete-btn",on:{click:t.deleteFile}})],1):e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploadLoading,expression:"uploadLoading"}],ref:"uploader",staticClass:"upload-demo",attrs:{drag:"",action:"","show-file-list":!1,accept:".btw","http-request":t.uploadFile}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("\n          将文件拖到此处，或\n          "),e("em",[t._v("点击上传")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})])],1)]),e("div",{staticClass:"search-form"},[e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"},[t._v("字段维护：")]),e("el-select",{attrs:{placeholder:"请选择",size:"small",multiple:"","collapse-tags":""},on:{change:t.handleSelect},model:{value:t.data.templateFieldIdList,callback:function(e){t.$set(t.data,"templateFieldIdList",e)},expression:"data.templateFieldIdList"}},t._l(t.options,(function(a){return e("el-option",{key:a.id,attrs:{label:a.fieldRemark+"/"+a.printCloumn,value:a.id}},[e("span",{staticStyle:{float:"left"}},[t._v(t._s(a.fieldRemark))]),e("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(a.printCloumn))])])})),1)],1)]),e("div",{staticClass:"search-form"},[e("div",{staticClass:"search-item"},[e("div",{staticClass:"search-title"}),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data.templateFieldList}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),e("el-table-column",{attrs:{prop:"printCloumn",label:"名称",width:"180",align:"center"}}),e("el-table-column",{attrs:{prop:"fieldRemark",label:"备注",width:"180",align:"center"}})],1)],1)])])},n=[],s=(a("7514"),a("96cf"),a("1da1")),i=a("307d"),l=a.n(i),u=a("2934"),c=a("106b"),o={data:function(){return{id:null,editType:"",data:{templateName:"",templateType:"",templateContent:"",templatePreview:"",templateFieldIdList:[],templateFieldList:[]},uploadLoading:!1,options:[],value:"",printerList:[]}},created:function(){this.getSelectList(),this.getPrinterList();try{var t=JSON.parse(l.a.decode(this.$route.query.data));this.id=t.id,this.editType=t.editType}catch(e){console.log(e),this.$router.push({name:"templateManagement"})}"编辑"==this.editType&&this.getDetail()},methods:{cancel:function(){this.$router.go(-1)},getSelectList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["i"])();case 2:if(e=t.sent,200==e.status){t.next=5;break}return t.abrupt("return",this.$message.error(e.message));case 5:this.options=e.result;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getPrinterList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["a"])();case 2:e=t.sent,this.printerList=e.result;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getDetail:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["j"])(this.id);case 2:if(e=t.sent,200==e.status){t.next=5;break}return t.abrupt("return",this.$message.error(e.message));case 5:this.data=e.result,e.result.templateFieldList.length>0?this.data.templateFieldIdList=e.result.templateFieldList.map((function(t){return t.id})):this.data.templateFieldIdList=[];case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),save:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("新建"!=this.editType){t.next=10;break}return t.next=3,Object(c["b"])(this.data);case 3:if(e=t.sent,200==e.status){t.next=6;break}return t.abrupt("return",this.$message.error(e.message));case 6:this.$message.success("新建成功"),this.cancel(),t.next=16;break;case 10:return t.next=12,Object(c["g"])(this.data);case 12:if(a=t.sent,200==a.status){t.next=15;break}return t.abrupt("return",this.$message.error(a.message));case 15:this.$message.success("修改成功");case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onEditorChange:function(t){t.editor;var e=t.html;t.text;this.data.templateContent=e},submit:function(){console.log(this.data.templateContent),this.$message.success("提交成功！")},uploadFile:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.uploadLoading=!0,a=new FormData,a.append("file",e.file),t.next=5,Object(u["f"])(a);case 5:if(r=t.sent,200!=r.status){t.next=17;break}return this.$message.success("上传成功"),t.next=10,Object(c["m"])(r.result.realAddress);case 10:n=t.sent,this.uploadLoading=!1,e.onSuccess(),this.data.templateContent=r.result.realAddress,this.data.templatePreview=n.result,t.next=20;break;case 17:this.uploadLoading=!1,this.$message.error("上传失败"),this.$refs.uploader.clearFiles();case 20:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),deleteFile:function(){var t=this;this.data.templateContent="",this.$nextTick((function(){t.$refs.uploader.clearFiles()}))},handleSelect:function(t){var e=this;console.log(t),t.length>0?this.data.templateFieldList=t.map((function(t){return e.options.find((function(e){return e.id==t}))})):this.data.templateFieldList=[]},doPrint:function(){}}},d=o,p=(a("a865"),a("2877")),m=Object(p["a"])(d,r,n,!1,null,"0a77533f",null);e["default"]=m.exports},a865:function(t,e,a){"use strict";a("b83d")},b83d:function(t,e,a){}}]);